YUI.add("reorder-grid-helper",(function(t,e){t.ReorderGridHelper=function(o,r,s){const i=require("hermes-core/flog")(e),a=t.mix({langBundles:["common","album-page"],appContext:o},t.Localizable),l=new t.TemplateLibraryHelper(o,{localizeLib:a});function n(e,o){let r=e,s=r.getValue("owner"),i=t.PhotoModelHelper.getSizeToFit(r.id,{width:o,height:o},{sizes:r.getValue("sizes"),includeSquare:!0,cropToFit:!0}).displayUrl;return l.getTemplate("drag-drop-photo-item")({displayUrl:i,title:r.getValue("title"),owner:{displayname:s.getValue("displayname")},isVideo:r.getValue("isVideo")})}t.ReorderGridHelper.DEFAULT_MANUAL_SORT_TYPE="manual-add-to-end",t.ReorderGridHelper.DEFAULT_SORT_TYPE="manual-add-to-end";class d{constructor({sortType:t="none"}={}){this.PER_PAGE=50,this.MAX_PER_PAGE=500,this.sortType=t,this.storedSortType=this.sortType,this.sortTypeNames={}}async load(t){const e=await this.loadCollection(this.modelParams);return this.listModel=e.listModel,this.collection=e.collection,this.currentPage=0,this.itemList=[],this.reorderedItemList=[],Promise.resolve()}async loadCollection(t){const e=await o.getModel(t.registryName,t.modelIdOrAttributes),r=e.getValue(t.collectionAttributeName);return{listModel:e,collection:r}}async loadPageFromCollection(t,e,o,r){try{const r=new Error("No more items to fetch from collection.",{cause:{noMoreItems:!0}});if(this.hasLoadedEnd)throw r;const s=await t.getPage({page:e,perPage:o});if(0===s.length)throw this.hasLoadedEnd=!0,r;return s}catch(t){return Promise.reject(t)}}async loadMore(t=(t=>t)){try{const e=await this.loadPage(++this.currentPage,this.PER_PAGE,t);return this.itemList=this.itemList.concat(e),this.reorderedItemList=this.reorderedItemList.concat(e),this.itemList.length>=this.collection.totalItems&&(this.hasLoadedEnd=!0),e}catch(t){throw this.currentPage--,t}}async loadPage(t,e,o=(t=>t)){try{let r=await this.loadPageFromCollection(this.collection,t,e,this.itemList);return r=r.filter(o),r}catch(t){throw t}}hasPredefinedSortType(){return!1}hasManualSortType(){return!1}hasNewPredefinedSortType(){return!1}hasNewManualSortType(){return!1}getSortMenuItems(){return[]}getCurrentSortTypeName(){return this.sortTypeNames[this.sortType]}setSortType(t){this.sortType=t}revertToManualSortType(){}async loadSortPreview(t){throw new Error("loadSortPreview not implemented")}async sortItems(t){throw new Error("sortItems not implemented")}async loadAllItems(t=1){const e=[];this.itemList=[],this.reorderedItemList=[],this.hasLoadedEnd=!1;for(let t=1;t<this.collection.totalItems/this.MAX_PER_PAGE+1;t++)e.push(this.loadPage(t,this.MAX_PER_PAGE).catch((t=>{if(t.cause.noMoreItems)return[];throw t})));return Promise.all(e).then((t=>(t.forEach((t=>{this.itemList=this.itemList.concat(t),this.reorderedItemList=this.reorderedItemList.concat(t),this.itemList.length>=this.collection.totalItems&&(this.hasLoadedEnd=!0)})),this.itemList)))}}return new{gallery:class extends d{constructor({galleryId:t}){super(),this.layout={maxWidth:140,itemSpacing:{horizontal:8,vertical:8}},this.modelParams={registryName:"gallery-info-models",modelIdOrAttributes:t,collectionAttributeName:"photoList"}}getItemTemplate(t){return n(t,this.layout.maxWidth)}async reorderItems(t){try{await this.listModel.reorderPhotosRemote(t);this.collection.reset(),this.collection.addPage({page:1,perPage:this.PER_PAGE,pageContent:this.reorderedItemList,totalItems:this.collection.totalItems,totalPages:this.collection.totalPages})}catch(t){return i.error("Error reordering photos",{err:t}),Promise.reject(t)}}},album:class extends d{constructor({albumId:t,sortType:e}){super({sortType:e}),this.layout={maxWidth:140,itemSpacing:{horizontal:8,vertical:8}},this.modelParams={registryName:"set-models",modelIdOrAttributes:t,collectionAttributeName:"photoPageList"},this.albumId=t,this.randomSortSeed=void 0,this.sortTypeNames={"date-taken-asc":a.intlMessage({intlName:"album-page.SORT_TAKEN_OLDEST"}),"date-taken-desc":a.intlMessage({intlName:"album-page.SORT_TAKEN_NEWEST"}),"date-posted-asc":a.intlMessage({intlName:"album-page.SORT_UPLOADED_OLDEST"}),"date-posted-desc":a.intlMessage({intlName:"album-page.SORT_UPLOADED_NEWEST"}),title:a.intlMessage({intlName:"album-page.SORT_ALPHABETICAL"}),random:a.intlMessage({intlName:"album-page.SORT_RANDOM"}),"manual-add-to-beginning":a.intlMessage({intlName:"album-page.SORT_MANUAL_BEGINNING"}),"manual-add-to-end":a.intlMessage({intlName:"album-page.SORT_MANUAL_END"})}}getItemTemplate(t){return n(t,this.layout.maxWidth)}async reorderItems(t,e){const r=this.reorderedItemList.map((t=>t.id)),s={photoset_id:this.albumId,photo_ids:r.join(","),sort_option:this.sortType};return o.callAPI("flickr.photosets.reorderPhotos",s)}async sortItems(t){const e={photoset_id:this.albumId,sort:t,seed:this.randomSortSeed},r=await o.callAPI("flickr.photosets.sortPhotos",e);return this.storedSortType=t,r}getSortMenuItems(){return Object.keys(this.sortTypeNames).map((t=>({text:this.sortTypeNames[t],value:t,isSelected:this.sortType===t,hasDivider:"manual-add-to-beginning"===t})))}async loadSortPreview(t){"random"===t&&(this.randomSortSeed=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER));const e={photoset_id:this.albumId,sort:t,preview:1,seed:this.randomSortSeed},r=o.callAPI("flickr.photosets.sortPhotos",e),s=this.loadAllItems();try{const e=await r,o=await s;let i=e&&e.photoset?e.photoset.photo:[];if(i.length&&o.length){let e=i.map((t=>o.find((e=>e.id===t.id))));return this.setSortType(t),e}}catch(t){throw t}}hasPredefinedSortType(){return!this.isManualSortType(this.sortType)}hasManualSortType(){return this.isManualSortType(this.sortType)}hasNewPredefinedSortType(){return this.sortType!==this.storedSortType&&!this.isManualSortType(this.sortType)}hasNewManualSortType(){return this.sortType!==this.storedSortType&&this.isManualSortType(this.sortType)}isManualSortType(t){return"manual-add-to-beginning"===t||"manual-add-to-end"===t}revertToManualSortType(){this.sortType=this.isManualSortType(this.storedSortType)?this.storedSortType:t.ReorderGridHelper.DEFAULT_MANUAL_SORT_TYPE}},albums:class extends d{constructor({ownerId:t}){super(),this.layout={maxWidth:180,itemSpacing:{horizontal:8,vertical:12}},this.modelParams={registryName:"sets-models",modelIdOrAttributes:t,collectionAttributeName:"albumsList"},this.ownerId=t}async load(){return await super.load(),this.albumModelRegistry=await o.getModelRegistry("set-models"),Promise.resolve()}getItemTemplate(t){let e=t,o=this.albumModelRegistry.getSizeToFit(e.id,{width:this.layout.maxWidth,height:this.layout.maxWidth}),r=o?o.displayUrl:"",s=e.getValue("photoCount"),i=e.getValue("videoCount");return l.getTemplate("drag-drop-album-item")({displayUrl:r,title:e.getValue("title"),photoCountString:a.intlMessage({intlName:"common.PHOTO_COUNT_FORMATTED",photoCount:s,countString:s}),videoCountString:a.intlMessage({intlName:"common.VIDEO_COUNT_FORMATTED",videoCount:i,countString:i}),hasVideos:i>0})}async reorderItems(t){var e={photoset_ids:this.reorderedItemList.map((t=>t.id)).join(",")};return o.callAPI("flickr.photosets.orderSets",e)}async loadMore(){return super.loadMore((function(t){return!t.getValue("isAutoUploadSet")}))}}}[r](s)}}),"@VERSION@",{requires:["event-custom","template-lib-helper","photo-model-helper","hermes-template-drag-drop-photo-item","hermes-template-drag-drop-album-item"],langBundles:["common","album-page"]});YUI.add("album-toolbar-view",(function(e,t){require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"fluid-magic-slideshow-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.nsidOrPathAlias=e.nsidOrPathAlias,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.params=e,this},loadState:function(){return this.appContext.getModel("set-models",this.albumId).then((e=>{this.set("albumModel",e)}))},buildContainer:function(){var e=this.get("albumModel"),t=e.id,o=!1;this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===e.getValue("owner").id&&(o=!0);let i={nsidOrPathAlias:this.nsidOrPathAlias,viewerIsOwner:o,viewerCanEdit:o&&!e.getValue("isAutoUploadSet"),setId:t};return this.appContext.flipper.isFlipped("enable_new_album_layout")?(i.isJustifiedLayout="justified"===this.albumPhotoListLayoutStyle,i.isStandardLayout="standard"===this.albumPhotoListLayoutStyle,i.isLargeLayout="large"===this.albumPhotoListLayoutStyle):(i.isJustifiedLayout="justified"===this.albumPhotoListLayoutStyle,i.isStoryLayout="story"===this.albumPhotoListLayoutStyle),this.setContainerWithTemplate("album-toolbar",i),this},activate:function(){var t=this.get("container"),o=this;return this.registerEventHandler(t.all(".layout").on("click",(function(i){i.preventDefault();var s=i.target.getAttribute("data-layout");s!==o.layoutStyle&&(t.one(".selected").removeClass("selected"),i.target.addClass("selected"),e.fire("albumToolbarView:layoutChange",s),o.layoutStyle=s)}))),this.addPhotosButton=t.one(".add-photo-button"),this.addPhotosButton&&this.registerEventHandler(this.addPhotosButton.on("click",this.showAddPhotosModal.bind(this))),this.reorderButton=t.one(".reorder-button"),this.reorderButton&&this.registerEventHandler(this.reorderButton.on("click",this.showReorderModal.bind(this))),this},showReorderModal:function(){var t=this,o=new e.ReorderGridHelper(this.appContext,"album",{albumId:this.albumId,sortType:this.get("albumModel").getValue("sortType")}),i=new e.Views["reorder-grid-modal-view"]({reorderHelper:o,hasSortMenu:!0,appContext:this.appContext});this.reorderModal=new e.Views.FluidModal({appContext:this.appContext,subview:i,dismissOnOverlayClick:!1,classList:["reorder-grid-modal"],width:Math.round(.8*Math.max(1280,e.config.win.innerWidth)),hasSubviewConfigRefactor:!0}),this.reorderModal.show(),i.registerEventHandler(e.on("reorderGridModal:close",(function(o){t.reorderModal.close(o),"done"===o.action&&(t.appContext.overlayManager.push({dismissOnOverlayClick:!1,disableBodyScroll:!0,dismissOnEsc:!1,showFlickrBalls:!0}),e.config.win.location.reload())})))},showAddPhotosModal:function(){this.photoSelectorView=new e.Views["photo-selector-view"]({appContext:this.appContext,enableMultiSelect:!0,enableVideos:!0,multiSelectLimit:e.config.flickr.api.max_photos_in_photoset,searchable:{yours:!0},navBarConfig:{links:[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream",selected:!0},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets"}],enableSearch:!0,breakpointConfig:[{maxWidth:700,enableSearch:!1},{maxWidth:500,enableSearch:!1}],onClose:e=>{this.photoSelectorModal.close()}},initialButtonState:{confirm:"disabled"},onConfirm:e=>this.handlePhotoSelectorConfirm(e)}),this.photoSelectorModal=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showCancelButton:!1,actionButtonDisabled:!0,subview:this.photoSelectorView,width:Math.round(.8*Math.max(1280,e.config.win.innerWidth)),height:Math.round(e.config.win.innerHeight-60),fullWindow:!0,hasSubviewConfigRefactor:!0,flexLayout:!0,classList:"photo-selector"}).show(),this.photoSelectorView.registerEventHandler(e.on("photoSelector:selected",(()=>{this.photoSelectorView.confirmView.setButtonState({confirm:""})}))),this.photoSelectorView.registerEventHandler(e.on("photoSelector:unselected",(e=>{e.wasLastPhotoSelected&&this.photoSelectorView.confirmView.setButtonState({confirm:"disabled"})})))},handlePhotoSelectorConfirm:function(){var t,o=this,i=this.get("albumModel"),s={},a=[],r=[],n=[],l=[];this.photoSelectorView.confirmView.setButtonState({confirm:"loading"}),this.photoSelectorView.get("selectionModel").getValue("photos").getList().forEach(((e,t)=>{let o=e.getValue("id");s[o]=e,e.getValue("isVideo")?l.push(o):n.push(o)})),t=Object.keys(s).length;for(var h=0;h<t;h+=500){let e=t;h+500<t&&(e=h+500),a.push(Object.keys(s).slice(h,e))}return a.forEach(((e,t)=>{let o=i.registry.remote.addPhoto({photoID:e.join(","),isMultiplePhotos:!0,photosSelectedIds:n,videosSelectedIds:l,numberOfPhotosSelected:n.length,numberOfVideosSelected:l.length,setID:i.getValue("id"),updateItemCounts:0===t},this.appContext).then((t=>{for(let o of e)t.errors&&t.errors.find((e=>e.photo_id===o))||i.addPhoto(s[o]);return{data:t,totalCount:e.length,successCount:e.length-(t.errors?t.errors.length:0),alreadyInErrCount:t.errors?t.errors.filter((e=>3===e.code)).length:0,otherErrCount:t.errors?t.errors.filter((e=>3!==e.code)).length:0}})).catch((e=>{throw console.log("err:",e),e}));r.push(o)})),e.Promise.all(r).then((t=>{let i=0,s=0,a=0,r=0;if(t.forEach((e=>{i+=e.totalCount,s+=e.successCount,a+=e.alreadyInErrCount,r+=e.otherErrCount})),a||r){if(a+r===i)throw a===i?new Error(1===a?this.intlMessage({intlName:"album-page.THAT_ALREADY_IN_ALBUM"}):this.intlMessage({intlName:"album-page.THOSE_ALREADY_IN_ALBUM"})):new Error(this.intlMessage({intlName:"products-flickrpro.SOMETHING_WENT_WRONG"}));const n=this.intlMessage({intlName:"album-page.X_OF_Y_ITEMS_ADDED_TO_ALBUM",successCountString:s,totalCountString:i});let l="";return a&&(l+=this.intlMessage({intlName:"album-page.X_ITEMS_ALREADY_IN_ALBUM",countString:a})),r&&(l+=a?"<br />":"",l+=this.intlMessage({intlName:"album-page.X_ITEMS_NOT_ADDED_TO_ALBUM",count:r,countString:r})),new Promise((i=>{let s=new e.Views.FluidModal({appContext:o.appContext,subview:new e.Views["confirmation-dialog-view"]({appContext:o.appContext,title:n,htmlMessage:l,showCancelButton:!1}),hasSubviewConfigRefactor:!0});s.show(),this.registerEventHandler(s.on("close",(()=>{i(t)})))}))}})).then((e=>(o.fire("subviewViewEvent","newPhotoAddedToAlbum"),o.photoSelectorModal.close(),e))).catch((t=>{new e.Views.FluidModal({appContext:o.appContext,subview:new e.Views["confirmation-dialog-view"]({appContext:o.appContext,title:o.intlMessage({intlName:"common.OOPS"}),htmlMessage:t.message,showCancelButton:!1}),hasSubviewConfigRefactor:!0}).show(),o.photoSelectorView.confirmView.setButtonState({confirm:""})}))}})}),"@VERSION@",{requires:["flickr-view","hermes-template-album-toolbar","confirmation-dialog-view","fluid-magic-slideshow-view","reorder-grid-modal-view","reorder-grid-helper"],optional:[],langBundles:["album-page","common","reorder","products-flickrpro"]});YUI.add("hermes-template-photo-list-header",(function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,a,l){return"hidden"},3:function(t,n,e,a,l){var s=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t\t\t<span class="stats-separator">&middot;</span>\n\t\t\t\t<a role="button" class="stat comment-count">\n\t\t\t\t\t'+t.escapeExpression((s(e,"intlHTMLMessage")||n&&s(n,"intlHTMLMessage")||t.hooks.helperMissing).call(null!=n?n:t.nullContext||{},{name:"intlHTMLMessage",hash:{countString:null!=n?s(n,"commentCountString"):n,commentCount:null!=n?s(n,"commentCount"):n,intlName:"common.COMMENT_COUNT_FORMATTED"},data:l,loc:{start:{line:31,column:5},end:{line:31,column:123}}}))+"\n\t\t\t\t</a>\n"},compiler:[8,">= 4.3.0"],main:function(t,n,e,a,l){var s,o,i=null!=n?n:t.nullContext||{},r=t.hooks.helperMissing,c="function",u=t.escapeExpression,m=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div role="main" class="photo-list-header-container">\n\t<section class="details-section">\n\t\t<header>\n\t\t\t<h1 class="title">'+u(typeof(o=null!=(o=m(e,"title")||(null!=n?m(n,"title"):n))?o:r)===c?o.call(i,{name:"title",hash:{},data:l,loc:{start:{line:4,column:21},end:{line:4,column:30}}}):o)+'</h1>\n\t\t\t<a role="button" class="read-more-title-button hidden" tabindex="0">'+u((m(e,"intlHTMLMessage")||n&&m(n,"intlHTMLMessage")||r).call(i,{name:"intlHTMLMessage",hash:{intlName:"common.DESCRIPTION_READ_MORE"},data:l,loc:{start:{line:5,column:71},end:{line:5,column:131}}}))+'</a>\n\t\t\t<a role="button" class="read-less-title-button hidden" tabindex="0">'+u((m(e,"intlMessage")||n&&m(n,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.DESCRIPTION_READ_LESS"},data:l,loc:{start:{line:6,column:71},end:{line:6,column:127}}}))+"</a>\n\t\t\t<p>"+u((m(e,"renderTrustedMarkup")||n&&m(n,"renderTrustedMarkup")||r).call(i,null!=n?m(n,"byString"):n,{name:"renderTrustedMarkup",hash:{},data:l,loc:{start:{line:7,column:6},end:{line:7,column:38}}}))+'</p>\n\t\t</header>\n\t\t<div class="description '+(null!=(s=m(e,"unless").call(i,null!=n?m(n,"description"):n,{name:"unless",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l,loc:{start:{line:9,column:26},end:{line:9,column:66}}}))?s:"")+'">\n\t\t\t<p>\n\t\t\t\t'+u((m(e,"renderTrustedMarkup")||n&&m(n,"renderTrustedMarkup")||r).call(i,null!=n?m(n,"description"):n,{name:"renderTrustedMarkup",hash:{},data:l,loc:{start:{line:11,column:4},end:{line:11,column:39}}}))+'\n\t\t\t</p>\n\t\t\t<span class="read-more-button toggle-button hidden">\n\t\t\t\t<a role="button" tabindex="0">'+u((m(e,"intlHTMLMessage")||n&&m(n,"intlHTMLMessage")||r).call(i,{name:"intlHTMLMessage",hash:{intlName:"common.DESCRIPTION_READ_MORE"},data:l,loc:{start:{line:14,column:34},end:{line:14,column:94}}}))+'</a>\n\t\t\t</span>\n\t\t\t<span class="read-less-button toggle-button hidden">\n\t\t\t\t<a role="button" tabindex="0">'+u((m(e,"intlMessage")||n&&m(n,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.DESCRIPTION_READ_LESS"},data:l,loc:{start:{line:17,column:34},end:{line:17,column:90}}}))+'</a>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="stats">\n\t\t\t<span class="stat photo-count">\n\t\t\t\t'+u(typeof(o=null!=(o=m(e,"itemCountString")||(null!=n?m(n,"itemCountString"):n))?o:r)===c?o.call(i,{name:"itemCountString",hash:{},data:l,loc:{start:{line:22,column:4},end:{line:22,column:23}}}):o)+'\n\t\t\t</span>\n\t\t\t<span class="stats-separator">&middot;</span>\n\t\t\t<span class="stat view-count">\n\t\t\t\t'+u((m(e,"intlHTMLMessage")||n&&m(n,"intlHTMLMessage")||r).call(i,{name:"intlHTMLMessage",hash:{countString:null!=n?m(n,"viewCountString"):n,viewCount:null!=n?m(n,"viewCount"):n,intlName:"common.VIEW_COUNT_FORMATTED"},data:l,loc:{start:{line:26,column:4},end:{line:26,column:110}}}))+"\n\t\t\t</span>\n"+(null!=(s=m(e,"if").call(i,null!=n?m(n,"hasCommentStats"):n,{name:"if",hash:{},fn:t.program(3,l,0),inverse:t.noop,data:l,loc:{start:{line:28,column:3},end:{line:33,column:10}}}))?s:"")+"\t\t</div>\n\t</section>\n</div>\n"},useData:!0}),a={};t.Array.each([],(function(n){var e=t.Template.get("hermes/"+n);e&&(a[n]=e)})),t.Template.register("hermes/photo-list-header",(function(n,l){return(l=l||{}).partials=l.partials?t.merge(a,l.partials):a,e(n,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-list-header-view",(function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},buildContainer:function(e){return e.description=this.getDescriptionAsHTML(),this.setContainerWithTemplate("photo-list-header",e),this},activate:function(){var t=this.get("container");return this.isCollapsed=!0,this.descripNode=t.one(".description"),this.descripContentNode=this.descripNode.one("p"),this.readMoreButton=t.one(".read-more-button a"),this.readLessButton=t.one(".read-less-button a"),this.titleNode=t.one(".title"),this.readMoreTitleButton=t.one(".read-more-title-button"),this.readLessTitleButton=t.one(".read-less-title-button"),this.reflow(),this.readMoreButton&&this.registerEventHandler(this.readMoreButton.on(["click","key"],this.expandDescription.bind(this),"down:13")),this.readLessButton&&this.registerEventHandler(this.readLessButton.on(["click","key"],this.collapseDescription.bind(this),"down:13")),this.readMoreTitleButton&&this.registerEventHandler(this.readMoreTitleButton.on(["click","key"],this.handleReadMoreTitleClick.bind(this),"down:13")),this.readLessTitleButton&&this.registerEventHandler(this.readLessTitleButton.on(["click","key"],this.handleReadLessTitleClick.bind(this),"down:13")),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handleResize.bind(this))),this},setupTitleUI:function(){this.titleNode.getDOMNode().scrollHeight>this.titleNode.getDOMNode().clientHeight+5?(this.titleNode.toggleClass("short",!0),this.readMoreTitleButton.toggleClass("hidden",!1)):(this.titleNode.toggleClass("short",!1),this.readMoreTitleButton.toggleClass("hidden",!0),this.readLessTitleButton.toggleClass("hidden",!0))},setupDescriptionUI:function(){let e=!0;if(!this.getDescription())return void this.descripNode.addClass("hidden");this.isCollapsed||(e=!1),this.descripNode.removeClass("hidden"),this.descripNode.setStyle("max-height","unset"),this.descripContentNode.setStyle("height","unset");let t=this.descripContentNode.get("region"),i=window.innerHeight,s=t.top,o=.2*i;this.descriptionHeight=t.height;let n=Math.max(i-s-o,75);this.descripNode.setStyle("max-height",`${n}px`),this.descriptionHeight<=75?this.descripNode.addClass("no-read-more"):(this.toggleDescription(e),this.descripNode.removeClass("no-read-more"))},handleReadMoreTitleClick:function(){this.titleNode.toggleClass("short",!1),this.titleNode.toggleClass("expanded",!0),this.readMoreTitleButton.toggleClass("hidden",!0),this.readLessTitleButton.toggleClass("hidden",!1),this.readLessTitleButton.focus()},handleReadLessTitleClick:function(){this.titleNode.toggleClass("short",!0),this.titleNode.toggleClass("expanded",!1),this.readLessTitleButton.toggleClass("hidden",!0),this.readMoreTitleButton.toggleClass("hidden",!1),this.readMoreTitleButton.focus()},expandDescription:function(){this.toggleDescription(!1)},collapseDescription:function(){this.toggleDescription(!0)},toggleDescription:function(e){this.descripNode.toggleClass("collapsed",e);let t=e?75:this.descriptionHeight+16;this.descripContentNode.setStyle("height",`${t}px`),this.readMoreButton.ancestor(".toggle-button",!0).toggleClass("hidden",!e),this.readLessButton.ancestor(".toggle-button",!0).toggleClass("hidden",e),this.isCollapsed=e},getDescriptionAsHTML:function(){let e=this.getDescription();return e=e.trim(),e=e.replace(/[\r\n]{2,}/g,"\r\r"),e=e.replace(/[\r\n]/g,"<br>"),e},handleResize:function(){this.reflow()},reflow:function(){this.setupTitleUI(),this.setupDescriptionUI()}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-header"],optionalRequires:["hermes-core"],optional:["set-models"],langBundles:["common","share-modal"]});YUI.add("hermes-lang-share-modal_es-us",(function(e,a){e.Intl.add("hermes/share-modal","es-US",{SHARE_ON_BLOGGER:[{type:0,value:"Compartir en blogger"}],SHARE_PHOTO:[{type:0,value:"Compartir foto"}],SHARE_PHOTOS:[{type:0,value:"Compartir fotos"}],SHARE_VIDEO:[{type:0,value:"Compartir video"}],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_BLOGGER:[{type:0,value:"por favor autoriza que Flickr pueda publicar en Blogger"}],SHARE_ON_FACEBOOK:[{type:0,value:"Compartir en Facebook"}],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_FACEBOOK:[{type:0,value:"por favor autoriza que Flickr pueda publicar en Facebook"}],SHARE_VIA_MAIL:[{type:0,value:"Compartir por correo"}],SHARE_ON_TUMBLR:[{type:0,value:"Compartir en Tumblr"}],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TUMBLR:[{type:0,value:"por favor autoriza que Flickr pueda publicar en Tumblr"}],PUBLISH_NOW:[{type:0,value:"Publicar ahora"}],ADD_TO_QUEUE:[{type:0,value:"Añadir a la cola"}],SAVE_AS_DRAFT:[{type:0,value:"Guardar como borrador"}],SHARE_ON_TWITTER:[{type:0,value:"Compartir en Twitter"}],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TWITTER:[{type:0,value:"por favor autoriza que Flickr pueda publicar en Twitter"}],SHARE_PHOTOSTREAM:[{type:0,value:"Compartir galería"}],SHARE_ALBUM:[{type:0,value:"Compartir álbum"}],SHARE_FAVORITES:[{type:0,value:"Compartir favoritas"}],AUTHORIZE_TO_SHARE:[{type:0,value:"Debes autorizar a Flickr para que comparta fotos en "},{type:1,value:"service"}],CONNECT_TO_SERVICE:[{type:0,value:"Conectarte a "},{type:1,value:"service"}],OK_TAKE_ME_TO_MY_SETTINGS:[{type:0,value:"Muy bien, llévame a mis ajustes"}],POST:[{type:0,value:"Publicar"}],SHARE:[{type:0,value:"Compartir"}],FRIENDS:[{type:0,value:"Amigos"}],FAMILY:[{type:0,value:"Familia"}],SCREEN_NAME_OR_EMAIL:[{type:0,value:"Nombre en pantalla o correo electrónico"}],INCLUDE_A_MESSAGE:[{type:0,value:"Incluye un mensaje"}],SHARE_THIS_VIA:[{type:0,value:"Comparte esto mediante..."}],SHARE_PREFERENCES:[{type:0,value:"preferencias para compartir"}],GRAB_THE_LINK:[{type:0,value:"Copiar el enlace"}],SHOW_SHORT_URL:[{type:0,value:"mostrar la dirección URL corta"}],INCLUDE_CONTENT_MARKED_AS:[{type:0,value:"Incluir contenido señalado como:"}],PS_ITEMS_NOT_PUBLIC:[{type:0,value:"Algunos de los elementos tu galería no son públicos."}],HERE_IS_PS_LINK:[{type:0,value:"Este es el enlace hacia la galería. ¡Sólo cópialo y pégalo!"}],YOU_CAN_ADD_GUEST_PASS:[{type:0,value:'Para que los destinatarios puedan verlas, puedes añadir un pase de invitado [¿<a class="guest-pass-link" title="'},{type:1,value:"title"},{type:0,value:'" data-action="follow" href="https://www.flickrhelp.com/hc/en-us/articles/4404069601172-Create-or-delete-temporary-Guest-Passes-in-Flickr">?</a>]'}],ADD_A_GUEST_PASS:[{type:0,value:"Añadir un pase de invitado"}],GUEST_PASS_COPY:[{type:0,value:"Los pases de invitado te permiten compartir las fotos que no son públicas. Cualquier persona puede ver tus fotos públicas en cualquier momento,ya sea si son miembros de Flickr o no. ¡Pero. Si quieres compartir fotos marcadas como amigos, familia o privadas, usa un pase de invitado. Si estás compartiendo fotos de un conjunto, puedes crear un pase de invitado que incluya cualquiera de tus fotos marcadas como amigos, familia o privada. Si estás compartiendo tu galería completa, puedes crear un Pase de invitado que incluya las fotos marcadas como amigos o familia (pero no tus fotos privadas)."}],VISIT_GUESTPASS_HISTORY:[{type:0,value:'Puedes visitar tu <a href="/invite/history/guests/" data-action="follow">Historial de pases de invitado</a> en cualquier momento cuando el pase expire.'}],SOMETHING_WRONG:[{type:0,value:"Ocurrió un error.<br>Actualiza tu navegador e inténtalo nuevamente."}],ERROR:[{type:0,value:"Error"}],OK:[{type:0,value:"OK"}],SHARE_GROUP:[{type:0,value:"Compartir grupo"}],MESSAGE:[{type:0,value:"Mensaje"}],EMAIL:[{type:0,value:"Correo electrónico"}],SIGN_IN_TO_EMAIL:[{type:0,value:"Debes iniciar sesión para compartir una foto. Inicia sesión e inténtalo de nuevo."}],LINK_ACCOUNT:[{type:0,value:"Vincular cuenta"}],ACCOUNT_SETTINGS:[{type:0,value:"Configuración de la cuenta"}],AUTHORIZE_FLICKR:[{type:0,value:"Autorizar a Flickr a usar tu cuenta en la página Configuración de la cuenta."}],COPY_TO_CLIPBOARD:[{type:0,value:"Presiona Ctrl+C (Win) o Command+C (Mac) para copiar este enlace cuando está seleccionado"}],HTML_EMBED:[{type:0,value:"código HTML insertado"}],EMAIL_BODY_PHOTOS:[{type:1,value:"username"},{type:0,value:" compartió "},{type:6,value:"count",options:{one:{value:[{type:7},{type:0,value:" fotos"}]},other:{value:[{type:7},{type:0,value:" foto"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo."}],EMAIL_BODY_ALBUM:[{type:1,value:"username"},{type:0,value:" compartió un álbum contigo."}],EMAIL_BODY_PHOTOSTREAM:[{type:1,value:"username"},{type:0,value:" compartieron sus galerías contigo."}],SHARE_PHOTOS_TO:[{type:6,value:"count",options:{one:{value:[{type:0,value:"Compartir "},{type:7},{type:0,value:" foto con:"}]},other:{value:[{type:0,value:"Compartir "},{type:7},{type:0,value:" fotos con:"}]}},offset:0,pluralType:"cardinal"}],SHARE_VIDEO_TO:[{type:6,value:"count",options:{one:{value:[{type:0,value:"Compartir "},{type:7},{type:0,value:" video con:"}]},other:{value:[{type:0,value:"Compartir "},{type:7},{type:0,value:" videos con:"}]}},offset:0,pluralType:"cardinal"}],SHARE_PHOTOSTREAM_TO:[{type:0,value:"Compartir galería con:"}],SHARE_ALBUM_TO:[{type:0,value:"Compartir álbum con:"}],SHARE_GALLERY_TO:[{type:0,value:"Compartir la expo en:"}],SHARE_EXPLORE_TO:[{type:0,value:"Compartir página de exploración con:"}],SHARE_SEARCH_TO:[{type:0,value:"Compartir resultados de búsqueda para:"}],SHARE_FAVES_TO:[{type:0,value:"Compartir favoritos con:"}],SHARE_ALBUMS_TO:[{type:0,value:"Compartir álbumes con:"}],SHARE_GROUP_TO:[{type:0,value:"Compartir grupo con:"}],FACEBOOK:[{type:0,value:"Facebook"}],TUMBLR:[{type:0,value:"Tumblr"}],TWITTER:[{type:0,value:"Twitter"}],X:[{type:0,value:"X"}],PINTEREST:[{type:0,value:"Pinterest"}],MAIL:[{type:0,value:"Correo"}],EMBED:[{type:0,value:"código HTML insertado"}],EMBED_SIMPLE:[{type:0,value:"Insertar"}],HTML:[{type:0,value:"HTML"}],GRAB_LINK:[{type:0,value:"Copiar enlace"}],BBCODE:[{type:0,value:"BBCode"}],VIA_FLICKR:[{type:0,value:"Por Flickr:"}],SHARE_PUBLIC_ONLY:[{type:0,value:"Solo fotos públicas"}],SHARE_FRIENDS:[{type:0,value:"Incluir fotos marcadas como Amigos"}],SHARE_FAMILY:[{type:0,value:"Incluir fotos marcadas como Familia"}],SHARE_FAMILY_AND_FRIENDS:[{type:0,value:"Incluir fotos marcadas como Familia y amigos"}],SHARE_FRIENDS_AND_FAMILY:[{type:0,value:"Incluir fotos marcadas como Familia y amigos"}],SHARE_PRIVATE:[{type:0,value:"Todas las fotos: públicas y privadas"}],SHARING_DISABLED:[{type:0,value:"La función de compartir está deshabilitada"}],ON_FLICKR:[{type:0,value:"en Flickr"}],PHOTO_PRIVATE_MESSAGE:[{type:0,value:'Esta foto es privada. Se agregará un pase de invitado [¿<a target="_blank" href="https://www.flickrhelp.com/hc/en-us/articles/4404069601172-Create-or-delete-temporary-Guest-Passes-in-Flickr/">?</a>] para que los destinatarios puedan verla.'}],PHOTO_FRIENDS_MESSAGE:[{type:0,value:'Solo tus amigos pueden ver esta foto. Se agregará un pase de invitado [¿<a target="_blank" href="https://www.flickrhelp.com/hc/en-us/articles/4404069601172-Create-or-delete-temporary-Guest-Passes-in-Flickr/">?</a>] para que los destinatarios puedan verla.'}],PHOTO_FAMILY_MESSAGE:[{type:0,value:'Solo tus familiares pueden ver esta foto. Se agregará un pase de invitado [¿<a target="_blank" href="https://www.flickrhelp.com/hc/en-us/articles/4404069601172-Create-or-delete-temporary-Guest-Passes-in-Flickr/">?</a>] para que los destinatarios puedan verla.'}],PHOTO_FAMILY_FRIENDS_MESSAGE:[{type:0,value:'Solo tus familiares y amigos pueden ver esta foto. Se agregará un pase de invitado [¿<a target="_blank" href="https://www.flickrhelp.com/hc/en-us/articles/4404069601172-Create-or-delete-temporary-Guest-Passes-in-Flickr/">?</a>] para que los destinatarios puedan verla.'}],PHOTO_CAMERAROLL_MESSAGE:[{type:0,value:"Los destinatarios podrán ver todas las fotos que hayas compartido, independientemente del nivel de privacidad."}],GUESTPASS_CREATION_FAILURE:[{type:0,value:"Se produjo un error al intentar generar el enlace para compartir.  Vuelve a intentarlo."}],CONTACT_SEARCH_ERROR:[{type:0,value:"Se produjo un error al intentar agregar un destinatario. Vuelve a intentarlo."}],FLICKR_SHARE_ERROR:[{type:0,value:"Se produjo un error al intentar compartir en Flickr. Vuelve a intentarlo."}],FLICKR_SHARE_SUCCESS:[{type:0,value:"¡Se han compartido tus elementos!"}],FLICKR_SHARE_SUCCESS_TITLE:[{type:0,value:"Éxito"}],CLICK_GENERATE_LINK:[{type:0,value:"Haz clic para generar un enlace para compartir"}],FLICKR_SHARE:[{type:0,value:"Compartir"}],COPY_MAC:[{type:0,value:"Presiona Command + C para copiar este enlace cuando esté seleccionado."}],COPY_PC:[{type:0,value:"Presiona Ctrl + C para copiar este enlace cuando esté seleccionado."}],CANCEL_SHARE_BECAUSE_ERROR:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"No se puede compartir esta foto. Inténtalo de nuevo más tarde."}]},other:{value:[{type:0,value:"No se pueden compartir estas fotos. Vuelve a intentarlo más tarde."}]}},offset:0,pluralType:"cardinal"}],LINK_PRIVACY_REMINDER:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"La foto privada en esta selección seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace."}]},other:{value:[{type:0,value:"Las fotos privadas en esta selección seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}]}},offset:0,pluralType:"cardinal"}],PHOTO_PAGE_PRIVACY_WARNING:[{type:0,value:"Esta foto seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace."}],CAMERAROLL_PRIVACY_WARNING:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"Esta foto seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace."}]},other:{value:[{type:0,value:"Las fotos que sean privadas en esta selección seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}]}},offset:0,pluralType:"cardinal"}],ALBUM_PRIVACY_WARNING:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"La foto privada en este álbum seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace."}]},other:{value:[{type:0,value:"Las fotos que sean privadas en este álbum seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}]}},offset:0,pluralType:"cardinal"}],PHOTOSTREAM_PRIVACY_WARNING:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"La foto privada en tu galería seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace."}]},other:{value:[{type:0,value:"Las fotos que sean privadas en tu galería seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}]}},offset:0,pluralType:"cardinal"}],CANCEL_SHARE_BECAUSE_RESTRICTED:[{type:0,value:"¡Lo sentimos! No puedes compartir fotos con restricciones."}],NO_SHAREABLE_ITEMS:[{type:0,value:"No hay elementos disponibles para compartir."}],CANT_SHARE_PRIVATE_GROUP_MESSAGE:[{type:0,value:'Solo los miembros de los grupos privados pueden verlos. <a data-action="follow" href="'},{type:1,value:"inviteURL"},{type:0,value:'">Invita amigos</a> para que se unan al grupo si quieres compartirlo.'}],CANT_SHARE_PRIVATE_GROUP_TITLE:[{type:0,value:"Compartir un grupo privado"}],EMBEDR_OPTION_HEADER:[{type:0,value:"Encabezado"}],EMBEDR_OPTION_FOOTER:[{type:0,value:"Pie de página"}],EMBEDR_OPTION_TRUNCATE:[{type:0,value:"Truncar"}],EMBEDR_OPTION_SLIDESHOW:[{type:0,value:"Diapositivas"}],EMBEDR_CHANGE_PRIVACY_WARNING:[{type:0,value:"¡Estás intentando incrustar una de tus fotos privadas! Si aún deseas incrustar esta foto, puedes hacerla pública seleccionando «Pública» en el menú de privacidad que se encuentra en la parte inferior de esta página."}],ALBUM_DOWNLOAD_ACCESS_YOU:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"Solo tú podrás descargar esta foto."}]},other:{value:[{type:0,value:"Solo tú podrás descargar estas fotos."}]}},offset:0,pluralType:"cardinal"}],ALBUM_DOWNLOAD_ACCESS_FF:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"Solo tus amigos y familiares podrán descargar esta foto."}]},other:{value:[{type:0,value:"Solo tus amigos y familiares podrán descargar estas fotos."}]}},offset:0,pluralType:"cardinal"}],ALBUM_DOWNLOAD_ACCESS_FOLLOWING:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"Solo las personas que sigues podrán descargar esta foto."}]},other:{value:[{type:0,value:"Solo las personas que sigues podrán descargar estas fotos."}]}},offset:0,pluralType:"cardinal"}],ALBUM_DOWNLOAD_ACCESS_MEMBERS:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"Solo los miembros de Flickr podrán descargar esta foto."}]},other:{value:[{type:0,value:"Solo los miembros de Flickr podrán descargar estas fotos."}]}},offset:0,pluralType:"cardinal"}],ALBUM_DOWNLOAD_ACCESS_EVERYONE:[{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"Todos podrán descargar esta foto."}]},other:{value:[{type:0,value:"Todos podrán descargar estas fotos."}]}},offset:0,pluralType:"cardinal"}],CHANGE_DOWNLOAD_PREF:[{type:0,value:'(<a href="'},{type:1,value:"url"},{type:0,value:'">Modificar tus preferencias de descarga</a>)'}],EMBED_WITH_GUESTPASS:[{type:0,value:"Habilita la vista para invitados"}],PHOTOSTREAM_PRIVATE:[{type:0,value:"Las fotos en tu transmisiones están marcadas como Privadas. Modifica la privacidad de tus fotos y vuelve a intentarlo."}],SHARE_THIS_IMAGE:[{type:0,value:"¡Comparte esta imagen!"}],TAP_TO_SHARE:[{type:0,value:"Toca la flecha para compartir con tus sitios web y aplicaciones favoritas."}],ENABLE_GUEST_PASS_PRINTING_PUBLIC:[{type:0,value:"Allow viewers to buy prints via a guest pass"}],ENABLE_GUEST_PASS_PRINTING:[{type:0,value:"Allow viewers to buy prints"}],MANAGE_GUEST_PASSES:[{type:0,value:"Manage your guest passes"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-curation-edit-view",(function(t,e){var n=t.Template.Handlebars.revive({1:function(t,e,n,l,a){return"has-collage"},3:function(t,e,n,l,a){return"\t\t\t\t<div></div>\n\t\t\t\t<div></div>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,n,l,a){var i,o,c=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,r=t.escapeExpression,u="function",m=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return r((m(n,"outlet")||e&&m(e,"outlet")||s).call(c,null!=e?m(e,"basic-closeable-header-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:1,column:0},end:{line:1,column:38}}}))+'\n<div class="curation-edit-container main">\n\t<div class="curation-edit-item curation-edit-title-item">\n\t\t<label for="curation-title-input">'+r((m(n,"intlMessage")||e&&m(e,"intlMessage")||s).call(c,{name:"intlMessage",hash:{intlName:"common.TITLE"},data:a,loc:{start:{line:4,column:36},end:{line:4,column:75}}}))+'</label>\n\t\t<input type="text" id="curation-title-input" class="input-field curation-title-input" placeholder="'+r((m(n,"intlMessage")||e&&m(e,"intlMessage")||s).call(c,{name:"intlMessage",hash:{intlName:"common.ADD_A_TITLE"},data:a,loc:{start:{line:5,column:101},end:{line:5,column:146}}}))+'" value="'+r(typeof(o=null!=(o=m(n,"title")||(null!=e?m(e,"title"):e))?o:s)===u?o.call(c,{name:"title",hash:{},data:a,loc:{start:{line:5,column:155},end:{line:5,column:164}}}):o)+'"/>\n\t</div>\n\t<div class="curation-edit-item curation-edit-description-item">\n\t\t<label for="curation-description-input">'+r((m(n,"intlMessage")||e&&m(e,"intlMessage")||s).call(c,{name:"intlMessage",hash:{intlName:"common.DESCRIPTION"},data:a,loc:{start:{line:8,column:42},end:{line:8,column:87}}}))+'</label>\n\t\t<textarea id="curation-description-input" class="input-field curation-description-input" placeholder="'+r((m(n,"intlMessage")||e&&m(e,"intlMessage")||s).call(c,{name:"intlMessage",hash:{intlName:"common.ADD_A_DESCRIPTION"},data:a,loc:{start:{line:9,column:104},end:{line:9,column:155}}}))+'" >'+r(typeof(o=null!=(o=m(n,"description")||(null!=e?m(e,"description"):e))?o:s)===u?o.call(c,{name:"description",hash:{},data:a,loc:{start:{line:9,column:158},end:{line:9,column:173}}}):o)+'</textarea>\n\t</div>\n\t<div class="curation-edit-item curation-edit-coverphoto-item">\n\t\t<label>'+r((m(n,"intlMessage")||e&&m(e,"intlMessage")||s).call(c,{name:"intlMessage",hash:{intlName:"common.COVER_PHOTO"},data:a,loc:{start:{line:12,column:9},end:{line:12,column:54}}}))+'</label>\n\t\t<div class="icon '+(null!=(i=m(n,"if").call(c,null!=e?m(e,"hasCollage"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:13,column:19},end:{line:13,column:55}}}))?i:"")+'">\n\t\t\t<div class="photo"></div>\n'+(null!=(i=m(n,"if").call(c,null!=e?m(e,"hasCollage"):e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a,loc:{start:{line:15,column:3},end:{line:18,column:10}}}))?i:"")+'\t\t</div>\n\t\t<a role="button" class="cover-photo-button" tabindex="0">'+r(typeof(o=null!=(o=m(n,"coverPhotoText")||(null!=e?m(e,"coverPhotoText"):e))?o:s)===u?o.call(c,{name:"coverPhotoText",hash:{},data:a,loc:{start:{line:20,column:59},end:{line:20,column:77}}}):o)+"</a>\n\t</div>\n</div>\n"+r((m(n,"outlet")||e&&m(e,"outlet")||s).call(c,null!=e?m(e,"basic-confirm-actions-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:23,column:0},end:{line:23,column:37}}}))+"\n"},useData:!0}),l={};t.Array.each([],(function(e){var n=t.Template.get("hermes/"+e);n&&(l[e]=n)})),t.Template.register("hermes/curation-edit-view",(function(e,a){return(a=a||{}).partials=a.partials?t.merge(l,a.partials):l,n(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("curation-edit-view",(function(e,i){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e,this.coverPhotoUrl="",this.subviewConfig["basic-closeable-header-view"]=Object.assign(this.subviewConfig["basic-closeable-header-view"],{title:e.title,showCloseXButton:!0,onClose:this.handleCloseClick.bind(this)}),this.subviewConfig["basic-confirm-actions-view"]=Object.assign(this.subviewConfig["basic-confirm-actions-view"],{showMessage:!0,message:e.deleteMessage,messageIsError:!1,messageIsClickable:!0,confirmButtonText:this.intlMessage({intlName:"common.SAVE"}),onCancel:this.handleCloseClick.bind(this),onConfirm:this.handleSaveClick.bind(this),onMessageClick:this.handleDeleteClick.bind(this)})},subviewConfig:{"basic-closeable-header-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1},"basic-confirm-actions-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1}},loadState:function(){return this.params.coverPhotoId?this.appContext.getModel("photo-models",this.params.coverPhotoId).then((e=>{this.primaryPhotoModel=e,this.coverPhotoUrl=this.primaryPhotoModel.getValue("sizes").sq.displayUrl})):e.Promise.resolve()},buildContainer:function(e){var i=this.intlMessage({intlName:"common.CHOOSE_A_COVER_PHOTO"});this.coverPhotoUrl&&(i=this.intlMessage({intlName:"common.CHANGE_COVER_PHOTO"})),e.coverPhotoText=i,this.setContainerWithTemplate("curation-edit-view",e)},activate:function(){var e=this.get("container");this.confirmView=this.subviews["basic-confirm-actions-view"],this.titleField=e.one(".curation-title-input"),this.descriptionField=e.one(".curation-description-input"),this.coverPhotoItem=e.one(".curation-edit-coverphoto-item"),this.coverPhotoNode=this.coverPhotoItem.one(".photo"),this.coverPhotoButton=e.one(".cover-photo-button"),this.coverPhotoButton&&this.registerEventHandler(this.coverPhotoButton.on(["click","key"],this.handleCoverPhotoClick.bind(this),"down:13")),this.titleField.focus(),this.showCoverPhoto(this.coverPhotoUrl)},showCoverPhoto:function(e){this.coverPhotoNode.setStyle("backgroundImage","url("+e+")")},handleCloseClick:function(){this.fire("readyToClose")},showConfirmDeleteModal:function(){new e.Views.FluidModal({appContext:this.appContext,subview:new e.Views["confirmation-dialog-view"]({appContext:this.appContext,title:this.intlMessage({intlName:"common.CONFIRMATION"}),htmlMessage:this.params.confirmDeleteMessage,confirmButtonIsDangerous:!0,onConfirm:()=>this.handleDeleteConfirmClick(),onCancel:()=>e.fire("curationEdit:deleteCanceled"),onClose:()=>e.fire("curationEdit:deleteCanceled")}),hasSubviewConfigRefactor:!0}).show()},handleCoverPhotoClick:function(){this.storeEditedMeta("curationEdit:coverPhotoClicked")},handleDeleteClick:function(){this.storeEditedMeta("curationEdit:deleteClicked"),this.showConfirmDeleteModal()},storeEditedMeta:function(i){e.fire(i,{storedEditMeta:{title:this.titleField.get("value"),description:this.descriptionField.get("value")}})}})}),"@VERSION@",{requires:["flickr-view","hermes-template-curation-edit-view"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("album-edit-view",(function(t,i){var e=require("hermes-core/flog")(i);t.FlickrView.create(this.name,t.namespace("Views")["curation-edit-view"],[],{langBundles:this.details.langBundles,initializer:function(t){this.params=t,this.albumModel=this.params.albumModel,this.nsidOrPathAlias=this.params.nsidOrPathAlias,this.coverPhotoUrl="",this.coverPhotoText=""},buildContainer:function(){var t={title:this.params.curationTitle,description:this.params.curationDescription};return this.constructor.superclass.buildContainer.call(this,t)},activate:function(){var t=this.get("container");this.titleField=t.one(".curation-title-input"),this.descriptionField=t.one(".curation-description-input"),this.constructor.superclass.activate.call(this)},handleSaveClick:function(i,r){r.setButtonState({confirm:"loading"});var a=this.albumModel.getValue("id"),o=[],l={title:this.titleField.get("value"),description:this.descriptionField.get("value")},s=!1;return this.albumModel&&this.albumModel.getValue("id")!==this.params.coverPhotoId&&(!1===this.albumModel.hasPhoto(this.primaryPhotoModel.id)?(s=!0,l.primary=this.primaryPhotoModel.id):l.primary=this.primaryPhotoModel.id),this.albumModel.setValues(l),o.push(this.albumModel.remoteUpdate(a)),t.Promise.all(o).then((i=>{s&&t.fire("albumEdit:primaryPhotoIsNewToAlbum"),r.setButtonState({confirm:""}),this.fire("readyToClose")})).catch((function(t){throw e.error("Error updating album info",{err:t}),r.setButtonState({confirm:""}),t}))},handleDeleteConfirmClick:function(){return this.albumModel.remoteDelete(this.albumModel.getValue("id")).then((i=>{t.config.win.location=this.nsidOrPathAlias?"/photos/"+this.nsidOrPathAlias+"/albums/":""})).catch((t=>{throw e.error("Error deleting album",{err:t}),this.deleteConfirmButton.removeAttribute("disabled"),t}))}})}),"@VERSION@",{requires:["flickr-view","curation-edit-view"],optionalRequires:["hermes-core"],langBundles:["common","album-page","global-nav"]});